<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>StreamFlow — Admin Dashboard</title>

   <link rel="stylesheet" href="{{ url_for('static', filename='css/dashb.css') }}">


    <script>
            let lastCount = {{ watchers }};

            setInterval(() => {
              fetch('/users')
                .then(res => res.json())
                .then(data => {
                  // update number on page
                  document.getElementById("watchers-count").innerText = data.count;

                  // detect new user
                  if (data.count > lastCount) {
                    console.log("New watcher joined!");
                  }

                  lastCount = data.count;
                });
            }, 1000);
    </script>


</head>
<body data-theme="dark">
  <div class="topbar">
    <div class="brand">
      <div class="logo" aria-hidden>
        <!-- simple logo -->
        <svg width="28" height="28" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <rect x="3" y="3" width="18" height="18" rx="4" fill="white" opacity="0.06"/>
          <path d="M7 8.5v7l5-3.5L7 8.5zM14 8v7h2V8h-2z" fill="white"/>
        </svg>
      </div>
      <div>
        <h1>ZygTek Coders</h1>
        <div class="muted">Let's watch togather</div>
      </div>
    </div>
<!-- Right side of the navigation bar -->
    <div class="top-actions">
      <div class="muted">Welcome, Admin</div>
      <label style="display:flex;align-items:center;gap:8px">
        <input id="themeToggle" type="checkbox" value="true" />
        <small class="muted">Dark mode</small>
      </label>
    </div>
  </div>

  <div class="app">
    <!-- admin information -->
    <aside class="sidebar" aria-label="Sidebar">
      <div class="profile">
        <img src="https://cdn-images-1.medium.com/v2/resize:fit:1200/1*Y3cwWPyJ7NCyc4b9L8jj2Q.png" alt="admin"/>
        <div class="who">
          <div style="font-weight:600">Code blossom</div>
          <div class="muted">stream@sblossom</div>
        </div>
      </div>

      <div class="chip">
        <h3>Filters & Navigation</h3>
    </div>

      <div class="filter-section">
        <h3>Search</h3>
        <div class="control"><input id="search" type="text" placeholder="Search by name, email, address"/></div>

        <h3>Gender</h3>
        <div class="control">
          <select id="genderFilter">
            <option value="">All</option>
            <option value="male">Male</option>
            <option value="female">Female</option>
            <option value="other">Other</option>
          </select>
        </div>

        <h3>Registered</h3>
        <div class="control">
          <input id="fromDate" type="date" />
          <input id="toDate" type="date" />
        </div>

        <h3>Sort By</h3>
        <div class="control">
          <select id="sortBy">
            <option value="newest">Newest register</option>
            <option value="oldest">Oldest register</option>
            <option value="timein">Time In (asc)</option>
            <option value="timeout">Time Out (asc)</option>
          </select>
        </div>

        <div style="display:flex;gap:8px;margin-top:8px">
          <button class="btn" id="apply">Apply</button>
          <button class="ghost small" id="clear">Clear</button>
        </div>

        <hr style="margin:14px 0;border:none;border-top:1px solid rgba(15,23,42,0.04)"/>

        <h3>Navigation</h3>
        <div style="display:flex;flex-direction:column;gap:8px">
          <button class="small ghost" onclick="viewAll()">All Users</button>
          <button class="small ghost" onclick="viewActive()">Active Now</button>
          <button class="small ghost" onclick="viewRecent()">Recently Registered</button>
          <button class="small ghost" onclick="viewByGender('female')">Female</button>
          <button class="small ghost" onclick="viewByGender('male')">Male</button>
        </div>

        <hr style="margin:14px 0;border:none;border-top:1px solid rgba(15,23,42,0.04)"/>

        <div style="display:flex;gap:8px">
          <button class="btn" id="reportBtn">Generate Report</button>
          <button class="ghost" id="refreshBtn">Refresh</button>
        </div>

      </div>

    </aside>
<!-- main page -->
    <main class="main">
      <div class="controls">
        <div class="stats">
            <div class="stat-card">
              <div style="font-size:12px" class="muted">Total Users</div>
              <div style="font-size:18px;font-weight:700">{{ total_users }}</div>
            </div>

            <div class="stat-card">
              <div style="font-size:12px" class="muted">Active Now</div>
              <div style="font-size:18px;font-weight:700">{{ active_now }}</div>
            </div>

            <div class="stat-card">
              <div style="font-size:12px" class="muted">New This Month</div>
              <div id="watchers-count" style="font-size:18px;font-weight:700">{{ new_month }}</div>
            </div>

            <!-- Total card -->
<!--          <div class="stat-card">-->
<!--            <div style="font-size:12px" class="muted">Total Users</div>-->
<!--            <div style="font-size:18px;font-weight:700" id="totalUsers">-</div>-->
<!--          </div>-->
<!--          &lt;!&ndash; Active now card &ndash;&gt;-->
<!--          <div class="stat-card">-->
<!--            <div style="font-size:12px" class="muted">Active Now</div>-->
<!--            <div style="font-size:18px;font-weight:700" id="activeNow">-</div>-->
<!--          </div>-->
<!--          &lt;!&ndash; New users card &ndash;&gt;-->
<!--          <div class="stat-card">-->
<!--            <div style="font-size:12px" class="muted">New This Month</div>-->
<!--            <div style="font-size:18px;font-weight:700" id="newMonth">-</div>-->
<!--          </div>-->
        </div>
        <!-- right card secion -->
        <div style="margin-left:auto;display:flex;gap:8px;align-items:center">
          <input id="quickSearch" type="text" placeholder="Quick search by name" style="padding:10px;border-radius:10px;border:1px solid rgba(15,23,42,0.06)" />
          <button class="ghost small" id="bulkDelete">Bulk delete</button>
        </div>
      </div>
      <!-- dashboard header -->
      <section>
        <div style="display:flex;align-items:center;gap:12px;margin-bottom:12px">
          <h2 style="margin:0">Users</h2>
          <div class="muted">Manage platform users and exported reports</div>

          <!-- change the dashboad -->
           <label style="display:flex;align-items:center;gap:8px">
        <input id="displayToggle" type="checkbox" />
        <small class="muted">Change display</small>
      </label>
        </div>
        <!-- table display -->
          <section class="table-card" id="table-view" style="display: none" >
      <h2 style="margin-top:0">Registered Users</h2>
      <table>
        <thead>
          <tr>
            <th>Photo</th>
            <th>Name</th>
            <th>Gender</th>
            <th>Email</th>
            <th>Address</th>
            <th>Date Registered</th>
            <th>Time In</th>
            <th>Time Out</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody id="usersTable" >
          <!-- rows injected by JS -->
        </tbody>
      </table>
    </section>


        <div class="grid" id="usersGrid">
          <!-- user cards go here -->
            {% for user in users %}
              <div class="user-card">
                <img src="{{ url_for('static', filename=user.photo) }}" width="100" height="100" alt="photo">
<!--                  <img src="{{ user.photo or 'https://via.placeholder.com/80' }}" alt="photo">-->
                <h5>{{ user.name }}</h5>
                <p class="muted">{{ user.email }}</p>
                <p>
                  Status:
                  <strong style="color: {{ 'green' if user.status == 'watching' else 'gray' }}">
                    {{ user.status }}
                  </strong>
                </p>
                <small>Joined: {{ user.join_time }}</small>
              </div>
            {% endfor %}

            <!--            end  -->
        </div>

      </section>

    </main>
  </div>

  <footer>
    <div style="display:flex;justify-content:space-between;align-items:center;gap:8px">
      <div class="muted">© <strong>StreamFlow</strong> — Admin dashboard</div>
      <div class="muted">Design: Creative • Data live-sync enabled</div>
    </div>
  </footer>

  <!-- modal -->
  <div id="modal" class="modal-backdrop" role="dialog" aria-modal="true">
    <div class="modal" id="modalContent">
      <h3 id="modalTitle">Confirm</h3>
      <p id="modalBody">Are you sure?</p>
      <div style="display:flex;gap:10px;justify-content:flex-end;margin-top:14px">
        <button class="ghost small" onclick="closeModal()">Cancel</button>
        <button class="btn" id="confirmAction">Yes, proceed</button>
      </div>
    </div>
  </div>

  <script src="{{ url_for('static', filename='js/dashb.js') }}"></script>
</body>
</html>
